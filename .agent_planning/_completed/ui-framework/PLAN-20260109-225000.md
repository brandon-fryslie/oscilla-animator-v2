# Sprint Plan: UI Framework Foundation
Generated: 2026-01-09 22:50:00

## Sprint Goal
Establish the foundational panel system using jsPanel4 and MUI, enabling resizable panels with tabs in a three-column layout.

## Scope

**In scope (this sprint):**
1. jsPanel4 integration and basic panel infrastructure
2. Core layout structure (toolbar, left sidebar, center, right sidebar, bottom log)
3. Tab support within panels using MUI Tabs

**Explicitly out of scope (future sprints):**
- Panel splitting (subdivide existing panels)
- Duplicate panel instances
- Layout persistence/save/restore
- Drag-and-drop panel rearrangement
- Panel docking
- Custom themes beyond dark mode basics
- All panel *content* (just wire existing components)

## Work Items

### P0: jsPanel4 + MUI Integration

**Acceptance Criteria:**
- [ ] jsPanel4 available via npm link from `~/code/brandon-fryslie_jsPanel4`
- [ ] MUI (Material UI v5) and Emotion dependencies installed
- [ ] TypeScript type declarations for jsPanel4 created (`.d.ts`)
- [ ] Basic jsPanel4 panel renders in browser without errors
- [ ] MUI ThemeProvider configured with dark theme

**Technical Notes:**
- Use `npm link` in jsPanel4 fork, then `npm link jspanel4` in project
- jsPanel4 uses UMD/ES6 - import from `es6module/jspanel.js`
- Create `src/ui/types/jspanel.d.ts` with minimal types
- MUI dark theme: `createTheme({ palette: { mode: 'dark' } })`

**Files to create/modify:**
- `package.json` - add MUI deps
- `src/ui/types/jspanel.d.ts` - type declarations
- `src/ui/theme.ts` - MUI theme config
- `public/index.html` - remove hard-coded layout CSS

### P1: Panel Infrastructure

**Acceptance Criteria:**
- [ ] `PanelManager` class that creates/tracks panels
- [ ] `PanelConfig` interface defining panel properties (id, title, position, size, content factory)
- [ ] Panels are resizable via jsPanel4's built-in resize
- [ ] Panels cannot be dragged (fixed layout mode)
- [ ] Panels fill their designated region responsively
- [ ] Tests: PanelManager can create panel, retrieve by id, destroy

**Technical Notes:**
- `PanelManager` singleton manages all panels
- Panel content injected via factory function: `(container: HTMLElement) => void`
- Use jsPanel4 `dragit: 'disabled'` for fixed position
- Use jsPanel4 `resizeit` for resize handles
- Store panels in `Map<string, jsPanel>`

**Files to create:**
- `src/ui/panel/PanelManager.ts`
- `src/ui/panel/types.ts`
- `src/ui/panel/index.ts`
- `src/ui/panel/__tests__/PanelManager.test.ts`

### P2: Core Layout with Tabs

**Acceptance Criteria:**
- [ ] Fixed toolbar at top (HTML, not jsPanel)
- [ ] Left sidebar panel (resizable width, fixed height to viewport)
- [ ] Center panel (fills remaining space)
- [ ] Right sidebar panel (resizable width)
- [ ] Bottom log panel (resizable height, collapsible)
- [ ] MUI Tabs component works inside a panel
- [ ] At least one panel demonstrates tabs (e.g., center panel with "Canvas" / "Patch" tabs)
- [ ] Existing components wired: canvas, PatchViewer, log, block inspector

**Technical Notes:**
- Layout regions use CSS flexbox as container, jsPanel for actual panels
- jsPanel `container` option places panel in specific DOM element
- Toolbar stays pure HTML/CSS (not a panel)
- Use jsPanel `position: { my: 'left-top', at: 'left-top', of: '#region' }` for placement
- MUI Tab content uses conditional rendering based on active tab index

**Files to create/modify:**
- `public/index.html` - new layout regions structure
- `src/ui/layout/AppLayout.ts` - creates the overall layout
- `src/ui/layout/regions.ts` - defines layout regions
- `src/ui/components/TabbedContent.ts` - MUI tabs wrapper
- `src/main.ts` - integrate with new layout system

## Dependencies

- jsPanel4 fork must be npm-linkable (es6module build exists âœ“)
- MUI installation requires npm
- Existing components (PatchViewer, Canvas, log) must remain functional

## Risks

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| jsPanel4 TypeScript integration issues | Medium | Medium | Start with `any` types, refine incrementally |
| jsPanel4 + MUI CSS conflicts | Low | Medium | Scope MUI styles within panel content |
| Responsive layout complexity | Medium | Low | Start with fixed breakpoints, enhance later |

## Definition of Done (Summary)

1. Dependencies installed and working (jsPanel4, MUI)
2. PanelManager creates and tracks panels
3. Three-column layout renders with resizable panels
4. Tabs work inside panels
5. Existing demo (canvas + patch viewer) runs in new layout
6. All tests pass
7. TypeScript compiles without errors
