Agent: iterative-implementer | 2026-01-17 05:22:00
Mode: manual
Completed: Sprint 7 - Runtime Migration | Files: 4 | Commits: 1
Cache invalidated: None (no eval cache entries existed for runtime files)
Status: complete

## Summary

Successfully migrated the runtime execution layer from domain-based to instance-based execution.

## Changes Made

### 1. Materializer.ts
- Updated function signature: `materialize(fieldId, instanceId: string, ...)`
- Changed parameter types: `DomainId` → `string`, `DomainDef` → `InstanceDecl`
- Buffer sizing now uses `instanceDecl.count`
- Layout access uses `instanceDecl.layout` (grid, unordered, etc.)
- Instance-based element ID generation: `${instance.id}:${i}`

### 2. ScheduleExecutor.ts
- Updated to use `schedule.instances` instead of `schedule.domains`
- Instance lookup from `instances.get(step.instanceId)`
- Count resolution from `instanceDecl.count`
- Added type casts for InstanceId compatibility

### 3. Integration Tests
- Updated assertion: `schedule.domains.size` → `schedule.instances.size`

### 4. types/index.ts
- Added `InstanceId` to exported types and constructor functions

## Verification

- Type check: Passes (only pre-existing UI errors remain)
- Runtime changes: All type-correct and consistent
- Test suite: Blocked by pre-existing block registry error (unrelated to this sprint)

## Architecture Notes

- Execution logic unchanged - same field materialization, same rendering
- Only type names and data structure access changed
- Runtime now compatible with Sprint 6 compiler output
- Instance count handling supports both `number` and `'dynamic'` (resolves to 0 for dynamic)
