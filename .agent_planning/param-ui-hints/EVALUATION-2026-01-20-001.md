# Evaluation: Param UI Hints

**Generated:** 2026-01-20
**Topic:** uiHint for Const block params

## Problem Statement

The user wants to specify a `uiHint` on the Const block's `params` object:

```typescript
registerBlock({
  type: 'Const',
  ...
  params: {
    value: 0,
    uiHint: { kind: 'slider', min: 1, max: 10000, step: 1 },
    // payloadType is set by normalizer after type inference
  },
  ...
});
```

Currently, the `uiHint` is placed inline in `params`, but this doesn't work because:

1. **The ParamField component looks for uiHint on InputDefs, not params** (line 1633-1635 of BlockInspector.tsx):
   ```typescript
   const inputDef = typeInfo.inputs.find(i => i.id === paramKey);
   const uiHint = inputDef?.uiHint;
   ```

2. **Const block has NO inputs** - it's polymorphic and gets its type from downstream connections. So there's no `InputDef` to attach a `uiHint` to.

3. **The uiHint in params is being treated as a param value itself**, which causes it to show up in the UI as an object that gets JSON-stringified.

## What Exists

### Current Architecture

1. **`InputDef.uiHint`** (registry.ts:92): The only place `uiHint` is currently supported
   - Works for blocks with inputs (Square, Array, etc.)
   - Links param to input by matching `paramKey` to `input.id`

2. **`UIControlHint` type** (types/index.ts:241-249): Well-defined union type for UI control hints:
   - `slider`, `int`, `float`, `select`, `color`, `boolean`, `text`, `xy`

3. **`ParamField` component** (BlockInspector.tsx:1632-): Renders individual params
   - Currently: looks for matching `inputDef` by paramKey, uses its `uiHint`
   - Falls back to type inference (boolean, number, string, object)

### Existing Usage

- `Square.inputs[0].uiHint` - works because Square has a `size` input
- `Array.inputs[0].uiHint` - works because Array has a `count` input
- `Const.params.uiHint` - BROKEN because Const has no inputs

## What's Missing

### 1. ParamDef with uiHint

There's no dedicated type for param definitions that includes uiHint. Currently params are just `Record<string, unknown>`.

### 2. Param-level uiHint lookup

The `ParamField` only looks for hints on matching inputs. Blocks without inputs (or with params that don't correspond to inputs) can't specify hints.

## Solution Options

### Option A: Add ParamDef type with uiHint (Standard Approach)

Add a new `ParamDef` type and modify `BlockDef.params` to be `Record<string, ParamDef | unknown>`:

```typescript
export interface ParamDef {
  value: unknown;
  uiHint?: UIControlHint;
  hidden?: boolean;  // For params like payloadType
}
```

**Pros:**
- Clean, explicit structure
- Can add more param metadata later (hidden, editable, etc.)
- Follows existing pattern (InputDef has uiHint)

**Cons:**
- Breaking change to all existing block registrations
- Need migration for all ~20+ blocks
- More verbose param definitions

### Option B: Separate `paramHints` object (Creative Approach)

Add a new `paramHints` field to `BlockDef`:

```typescript
export interface BlockDef {
  ...
  params?: Record<string, unknown>;
  paramHints?: Record<string, UIControlHint>;
  ...
}
```

Usage:
```typescript
registerBlock({
  type: 'Const',
  params: { value: 0 },
  paramHints: { value: { kind: 'slider', min: 1, max: 10000, step: 1 } },
});
```

**Pros:**
- Non-breaking - existing blocks keep working
- Clear separation of data vs. UI hints
- Easy to add incrementally

**Cons:**
- Two places to look for param info
- Param key must be duplicated

### Option C: Inline check in ParamField (Minimal Fix)

Keep current structure but add special handling in `ParamField` to check if a param value looks like a uiHint and skip it, plus check for a sibling `${paramKey}Hint` param:

```typescript
params: {
  value: 0,
  valueHint: { kind: 'slider', min: 1, max: 10000, step: 1 },
}
```

**Pros:**
- Smallest change
- No type changes needed

**Cons:**
- Hacky, implicit convention
- Pollutes params namespace
- Hard to validate

## Recommendation

**Option B (paramHints)** is recommended:
- Non-breaking change
- Clear semantics
- Matches existing pattern of "hints are separate from data"
- Easy to implement and test

## Dependencies

- None blocking - this is UI-only change

## Risks

- Low risk: UI change only, doesn't affect compilation or runtime
- Testing: Need to verify hint rendering works for Const block

## Verdict

**CONTINUE** - Requirements are clear, solution approach identified.
