Agent: iterative-implementer | 2026-01-09 08:28:49
Mode: manual
Completed: Complete type system migration | Files: 13 | Commits: 1
Status: complete

=== MIGRATION SUMMARY ===

Successfully migrated all code from legacy TypeDesc to canonical SignalType system.

FILES MIGRATED:
1. src/blocks/registry.ts - InputDef.type and OutputDef.type now use SignalType
2. src/transforms/index.ts - Transform definitions migrated to SignalType
3. src/compiler/ir/lowerTypes.ts - Port specs now use SignalType
4. src/compiler/passes-v2/pass2-types.ts - Completely rewritten for canonical axes
5. src/types/index.ts - Removed TypeDesc exports, added SignalType exports
6. src/core/types.ts - DELETED legacy TypeDesc system, kept primitives only

ADDITIONAL FIXES:
- src/compiler/blocks/render/FieldFromDomainId.ts - Fixed DomainId branding
- src/compiler/blocks/render/RenderInstances2D.ts - Fixed DomainId branding
- src/compiler/passes-v2/combine-utils.ts - Added LegacyTypeDesc compatibility layer
- Deleted src/core/__tests__/type-adapter.test.ts (obsolete)

LEGACY CODE DELETED:
- typeDescToSignalType()
- signalTypeToTypeDesc()
- mapDomainToPayload()
- mapPayloadToDomain()
- sigType(), fieldType(), scalarType(), eventType() (legacy versions)
- createTypeDesc()
- getTypeArity()
- inferBundleLanes()
- TypeDesc, TypeWorld, Domain type definitions
- CoreDomain, InternalDomain types

VALIDATION:
- npm run typecheck: PASS
- npm run test: PASS (123/123 tests, 7 test files)
- No remaining TypeDesc/Domain/TypeWorld imports in production code

The canonical SignalType system is now the single source of truth:
- PayloadType: what the value is (float, int, vec2, color, bool, phase, unit)
- 5-Axis Extent: where/when/about-what
  - Cardinality: zero/one/many
  - Temporality: continuous/discrete
  - Binding: unbound/weak/strong/identity
  - Perspective: global (v0)
  - Branch: main (v0)

Commit: fafd9db "refactor(types): migrate from legacy TypeDesc to canonical SignalType"
