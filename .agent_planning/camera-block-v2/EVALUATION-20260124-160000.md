# Evaluation: Camera Block Implementation

Generated: 2026-01-24T16:00:00Z
Verdict: CONTINUE

## Current State

The camera system is **substantially implemented** but has **test breakage** in the current branch (`ralphie`) due to in-progress changes that added `cameraProjection` to the type system's generic block resolution.

### What Already Exists (Spec-Compliant)
- `src/blocks/camera-block.ts` - Camera block with 9 input ports, proper defaults
- `src/compiler/ir/program.ts` - `CameraDeclIR` with 9 slot fields
- `src/runtime/CameraResolver.ts` - Slot-based resolution with deterministic sanitization
- `src/runtime/RenderAssembler.ts` - Uses `ResolvedCameraParams` from resolver
- `src/runtime/ScheduleExecutor.ts` - Calls `resolveCameraFromGlobals()` after schedule
- `src/projection/ortho-kernel.ts` - Pure ortho projection
- `src/projection/perspective-kernel.ts` - Pure perspective projection with `deriveCamPos()`
- Compiler validates single Camera block (E_CAMERA_MULTIPLE)

### What's Broken (This Branch)
The changes on the `ralphie` branch added:
1. `cameraProjection` to `ALL_CONCRETE_PAYLOADS` in registry.ts
2. `cameraProjection` case in Const block lowering (signal-blocks.ts)
3. Payload/unit specialization in `pass2-types.ts` `getPortType()`
4. Unit inference in `pass0-polymorphic-types.ts`

But introduced a bug: `getPortType()` now reads `block.params.payloadType` which can be `undefined` when `block.params` itself is undefined (blocks without params). This causes 21 test failures.

### Test Categories Failing
1. **pass2-types crash** (3 tests) - `block.params` can be undefined → null pointer
2. **Compilation integration** (steel-thread tests, level1, level5, level7) - Downstream of pass2 crash
3. **level10-golden-tests** (6 tests) - Missing type imports (`CompiledProgramIR`, `RuntimeState`, `ValueSlot`)

## Hardcoded Camera Values Audit

All remaining "hardcoded" values are **spec-correct defaults**:
- `ORTHO_CAMERA_DEFAULTS` (near=-100, far=100) - ortho kernel identity
- `PERSP_CAMERA_DEFAULTS` - derived from Camera block defaults via `deriveCamPos()`
- `DEFAULT_CAMERA` in CameraResolver - spec §6.2 defaults when no Camera block
- `camTargetZ: 0`, `camUp: [0,1,0]` in RenderAssembler - world conventions (not user-configurable)

**No illegitimate hardcoding exists.** The "bullshit" is the broken test state, not architectural violations.

## What Needs to Be Done

1. Fix the `block.params` null safety in `pass2-types.ts:282`
2. Fix missing type imports in `level10-golden-tests.test.ts`
3. Verify all 86 test files pass
4. Verify typecheck passes
