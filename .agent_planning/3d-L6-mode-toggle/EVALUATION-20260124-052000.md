# Evaluation: 3D L6 Mode Toggle
Generated: 2026-01-24T05:20:00

## Topic
Level 6 of the 3D rendering system DoD: Projection Mode Toggle (Ortho ↔ Perspective Switch)

## Current State

### Prerequisites
All prerequisites (L1-L5) are satisfied:
- L1: ✅ executeFrame produces stride-3 Float32Array position buffers
- L2: ✅ Ortho kernel has zero runtime imports; identity holds
- L3: ✅ Both kernels identical signatures/shapes; perspective differs from ortho
- L4: ✅ Size projection is identity under ortho; same module as kernels
- L5: ✅ executeFrame with camera produces populated screen-space fields; world buffers unchanged

### Existing Infrastructure
The infrastructure for Level 6 is **already in place**:

1. **`ProjectionMode` type** exists (`RenderAssembler.ts:56`): `'orthographic' | 'perspective'`
2. **`CameraParams` discriminated union** (`RenderAssembler.ts:61-63`): `{ mode: 'orthographic'; params: OrthoCameraParams } | { mode: 'perspective'; params: PerspectiveCameraParams }`
3. **`projectInstances()`** already has the if/else branch for both modes (`RenderAssembler.ts:108-114`)
4. **`executeFrame()`** accepts camera as a parameter argument, NOT stored in state (`ScheduleExecutor.ts:200`)
5. **Camera flows through arguments only**: `executeFrame` → `assemblerContext` → `assembleRenderPass` → `projectInstances`

### What Level 6 Actually Tests
This level doesn't require new implementation code. The architecture is already correct. What's needed is **tests that prove**:
- Toggling modes doesn't trigger recompilation
- Runtime state is preserved across toggle
- Continuity state is preserved across toggle
- Output differs between modes (for off-center instances)
- Toggling back produces bitwise-identical output
- World-space trajectories are smooth across toggle points

## Verdict: CONTINUE

No blockers, no ambiguities. The implementation is done; we only need tests.

## Risk Assessment
- **LOW risk**: All code paths already exist and were tested in L5. L6 tests just exercise them with mode switching.
- **Key concern**: The "State Preservation" integration tests require accessing `CompiledProgramIR` and `RuntimeState` internals. Need to verify what's inspectable.
