# Sprint Plan: Domain Editor UI

**Created:** 2026-01-09
**Topic:** Domain Editor UI
**Status:** PLANNING COMPLETE - IMPLEMENTATION DEFERRED
**Phase:** Phase 2 (Rendering & UI)

---

## Context

This topic designs the UI for creating and configuring domain blocks in the visual patch editor. Based on research of similar tools (Houdini, Nuke, Cables.gl), we recommend the **Parameter Panel + Presets** pattern.

**Dependencies:**
- Phase 1 Core Foundation must be complete
- Requires patch-editor-ui infrastructure (PropertyPanel component)

---

## Sprint Goal

When Phase 2 begins, implement a property panel UI that allows users to configure domain blocks (GridDomain, DomainN) with both presets and custom parameters.

---

## Scope

**In scope:**
1. PropertyPanel component (generic, reusable for all blocks)
2. Parameter metadata system for block configuration
3. Domain-specific presets (GridDomain, DomainN)
4. Real-time recompilation on parameter change

**Out of scope (future):**
- Visual domain preview (grid visualization)
- User-defined presets
- PathDomain, ImageDomain support
- Memory estimation/validation

---

## Deliverables

### P0: PropertyPanel Component

**Goal:** Generic property panel for editing block parameters.

**Features:**
- Numeric slider + input for integer/float parameters
- Range constraints (min, max, step)
- Label and optional description
- Real-time updates to block.params

**Component API:**
```typescript
interface PropertyPanelProps {
  block: Block;
  metadata: BlockMetadata;
  onParamChange: (paramName: string, value: unknown) => void;
}
```

### P1: Parameter Metadata System

**Goal:** Define parameter specs per block type.

**Example:**
```typescript
const GridDomainMetadata: BlockMetadata = {
  type: 'GridDomain',
  params: [
    { name: 'rows', type: 'number', min: 1, max: 1024, step: 1, default: 8 },
    { name: 'cols', type: 'number', min: 1, max: 1024, step: 1, default: 8 },
  ],
  presets: [
    { label: '2×2', params: { rows: 2, cols: 2 } },
    { label: '4×4', params: { rows: 4, cols: 4 } },
    { label: '8×8', params: { rows: 8, cols: 8 } },
    { label: '16×16', params: { rows: 16, cols: 16 } },
    { label: '32×32', params: { rows: 32, cols: 32 } },
  ],
};
```

### P2: Domain Presets UI

**Goal:** Quick preset buttons for common configurations.

**UI:**
```
Quick Presets: [2×2] [4×4] [8×8] [16×16] [32×32]
```

Clicking a preset applies all its params to the block.

### P3: Integration with Patch Editor

**Goal:** Wire property panel to patch editing flow.

**Flow:**
1. User selects domain block in canvas
2. Property panel shows block's parameters
3. User edits via slider/input or clicks preset
4. onParamChange fires → patch.blocks[i].params updated
5. Recompile triggered → animation updates

---

## Implementation Sequence

1. **Phase 2A: PropertyPanel Component** (2-3 days)
   - Create PropertyPanel React/Svelte/etc component
   - NumericInput with slider
   - Preset button group
   - Hook to onParamChange

2. **Phase 2B: Metadata System** (1 day)
   - Define BlockMetadata interface
   - Add metadata for GridDomain, DomainN
   - Registry lookup by block.type

3. **Phase 2C: Integration** (1-2 days)
   - Wire PropertyPanel to patch editor
   - Selection → panel update
   - Param change → recompile flow
   - Test with live domain changes

**Total Effort:** 4-6 days when Phase 2 begins

---

## Acceptance Criteria (Preview)

When implementation begins, these will be the DoD:

- [ ] PropertyPanel component renders numeric controls
- [ ] GridDomain shows rows/cols sliders
- [ ] DomainN shows count/seed inputs
- [ ] Presets apply full parameter sets on click
- [ ] Parameter changes trigger recompilation
- [ ] Animation updates in real-time
- [ ] No TypeScript errors
- [ ] Component tests pass

---

## Risk Assessment

**Low Risk:**
- Standard UI pattern (property panel)
- No novel interactions
- Proven in similar tools

**Dependencies:**
- Needs patch-editor-ui canvas and selection system
- Needs compile-on-change infrastructure

---

## Status

**PLANNING COMPLETE - IMPLEMENTATION DEFERRED**

This is a Phase 2 topic. Full DoD and implementation will happen when:
1. Phase 1 Core Foundation is complete
2. patch-editor-ui begins development
3. PropertyPanel becomes the shared component for all blocks

---

## Related Topics

- `patch-editor-ui` - Parent topic for visual editor
- `compilation-pipeline` - Domain unification (Phase 1, COMPLETE)
- `renderer-implementation` - Phase 2 rendering
