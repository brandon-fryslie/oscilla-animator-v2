# Evaluation: Dockview Integration
Generated: 2026-01-15T16:00:00

## Topic
Replace jspanel4 completely with Dockview as the layout engine for Oscilla Animator.

## Current State

### jspanel4 Status
- **Infrastructure exists but is 100% UNUSED (dead code)**
- Files present: PanelManager.ts, types.ts, jspanel.d.ts, AppLayout.ts
- Zero calls to `createPanel()` anywhere in codebase
- Local fork at `~/code/brandon-fryslie_jsPanel4` (never used)

### Current Layout System
- Pure React + CSS flexbox in App.tsx
- Hardcoded 4-region layout: left sidebar, center, right sidebar, bottom
- Custom SplitPanel and Tabs components
- No serialization/persistence

### Existing Components (to migrate)
| Component | Location | Current Container |
|-----------|----------|-------------------|
| BlockLibrary | left-top | SplitPanel |
| BlockInspector | left-bottom | SplitPanel |
| TableView | center | Tabs |
| ConnectionMatrix | center | Tabs |
| ReteEditor | center | Tabs |
| ReactFlowEditor | center | Tabs |
| CanvasTab (Preview) | center | Tabs |
| DomainsPanel | right | Tabs |
| HelpPanel | right | Tabs |
| DiagnosticConsole | bottom | Direct |

### State Management
- MobX stores with single source of truth
- EditorContext for editor handle abstraction
- LocalStorage only for BlockLibrary collapsed categories

## What's Missing

1. **Dockview package** - not installed
2. **Layout persistence** - no save/restore
3. **Floating panels** - not possible with current system
4. **Popout windows** - not possible with current system
5. **User-customizable layout** - hardcoded

## What Needs to Change

### Files to Delete (jspanel4 dead code)
- `src/ui/panel/PanelManager.ts`
- `src/ui/panel/types.ts`
- `src/ui/panel/__tests__/PanelManager.test.ts`
- `src/ui/types/jspanel.d.ts`
- `src/ui/layout/AppLayout.ts`
- `src/ui/layout/regions.ts`

### Files to Modify
- `package.json` - remove jspanel4 deps, add dockview
- `vite.config.ts` - remove jspanel4 alias
- `public/index.html` - remove jsPanel CSS
- `src/ui/components/app/App.tsx` - replace layout with DockviewProvider

### Files to Create
- `src/ui/dockview/index.ts`
- `src/ui/dockview/DockviewProvider.tsx`
- `src/ui/dockview/panelRegistry.ts`
- `src/ui/dockview/hooks.ts`
- `src/ui/dockview/theme.css`
- `src/ui/dockview/defaultLayout.ts`
- `src/stores/LayoutStore.ts`
- `public/popout.html` (placeholder for future)

## Dependencies
- dockview (npm package)
- dockview-react (npm package)

## Risks
| Risk | Mitigation |
|------|------------|
| Layout breaks during migration | Single atomic change, test immediately |
| Existing components incompatible | Components are pure React, just need wrapper |
| Theme mismatch | CSS variables map directly to existing theme |

## Ambiguities
None significant. The plan is straightforward:
1. Delete dead code
2. Install dockview
3. Create infrastructure
4. Migrate components
5. Add persistence

## Verdict: CONTINUE

This is a clean replacement with no legacy migration complexity. The jspanel4 code is completely unused, making this a pure addition of Dockview.

## Confidence Assessment: HIGH

- Clear implementation path
- Well-documented target library (Dockview)
- No complex migration (jspanel4 unused)
- User has already approved architectural approach
