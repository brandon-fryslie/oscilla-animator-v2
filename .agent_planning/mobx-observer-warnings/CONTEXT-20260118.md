# Context: MobX Observer Warnings

**Topic**: mobx-observer-warnings
**Created**: 2026-01-18
**Status**: PLANNING

## Problem Statement

The browser console is showing MobX warnings:
```
[mobx] Derivation 'observer' is created/updated without reading any observable value.
```

This indicates that some React components are wrapped with `observer()` but don't actually read any MobX observables, which is unnecessary and causes warnings.

## Investigation Findings

### Components with `observer` wrapper

Components that ARE reading observables (correct usage):
1. **BlockLibrary.tsx** - Reads `rootStore.selection` (line 113)
2. **DiagnosticConsole.tsx** - Reads `rootStore.diagnostics.activeDiagnostics` and `revision` (lines 37-38)
3. **LogPanel.tsx** - Reads `rootStore.diagnostics.logs` (line 23)
4. **DomainsPanel.tsx** - Reads `rootStore.patch.patch` (line 31)
5. **ConnectionMatrix.tsx** - Reads `rootStore.patch.patch` (line 63)
6. **TableView.tsx** - (need to verify)
7. **BlockInspector.tsx** - (need to verify)

### Panel Wrappers (non-observer)

The Dockview panel wrappers are plain React components that just wrap the actual components:
- BlockLibraryPanel.tsx
- DiagnosticConsolePanel.tsx
- HelpPanelWrapper.tsx
- DomainsPanelWrapper.tsx
- PreviewPanel.tsx
- etc.

These are NOT wrapped with observer, which is correct since they just pass through to the underlying components.

### Likely Culprits

The warning "Derivation 'observer' is created/updated without reading any observable value" suggests components wrapped with `observer()` that don't actually use MobX state.

**HelpPanel.tsx** - This component is NOT wrapped with observer (correct - it's static content)

Need to investigate:
1. CanvasTab.tsx - Check if it's wrapped with observer
2. Any other components that might be unnecessarily wrapped

### Architecture Context

From RootStore.ts:
- MobX configured in strict mode via `configureMobX()` (line 34)
- RootStore provides all stores via React Context
- Components access stores via `useStores()` hook

## Root Cause Hypothesis

The warnings are likely from one of these scenarios:

### Scenario A: Unnecessary Observer Wrapper
A component is wrapped with `observer()` but doesn't read any observables. This could be:
- A wrapper component that just passes through
- A component that was refactored to not use observables but kept the wrapper
- A component using observables incorrectly (not dereferencing them)

### Scenario B: Observer Not Reading in Render
A component reads observables in useEffect/callbacks but not in render function, which MobX can't track.

### Scenario C: Multiple Observer Wrappers
A component is wrapped with observer twice (once in the component definition, once in the wrapper).

## Next Steps for Planning

1. ✅ Identify all components wrapped with `observer()`
2. ⏳ For each, verify if it actually reads observables in render
3. ⏳ Connect Chrome DevTools via MCP to see console warnings in real-time
4. ⏳ Identify which specific components are triggering the warnings
5. ⏳ Create fix strategy based on findings

## Files to Review

- [ ] src/ui/components/CanvasTab.tsx
- [ ] src/ui/components/TableView.tsx
- [ ] src/ui/components/BlockInspector.tsx
- [ ] src/ui/components/InspectorContainer.tsx
- [ ] Any other components that might use observer

## Verification Strategy

Once Chrome DevTools is connected, we can:
1. Reload the page
2. Observe which components trigger the warning
3. Use React DevTools to identify the component tree
4. Match warnings to specific components
5. Verify our hypothesis and create targeted fixes
