# Definition of Done: Auto-Arrange Layout

**Bead:** `oscilla-animator-v2-8fp`
**Date:** 2026-01-18

---

## Acceptance Criteria

### Mandatory

- [ ] `elkjs` package installed
- [ ] Layout utility created (`src/ui/reactFlowEditor/layout.ts`)
- [ ] "Auto Arrange" button visible in React Flow editor toolbar
- [ ] Clicking button arranges nodes left-to-right in layers
- [ ] Button shows loading state ("Arranging...") during computation
- [ ] View auto-fits after layout completes
- [ ] `EditorHandle.autoArrange()` method implemented
- [ ] `npm run typecheck` passes
- [ ] `npm run build` passes

### Visual Verification

- [ ] Nodes arrange in clean columns (sources left, sinks right)
- [ ] Edges flow from left to right without excessive crossing
- [ ] Spacing between nodes is consistent (~100px horizontal, ~80px vertical)
- [ ] Layout respects graph topology (connected nodes in proper sequence)
- [ ] Works correctly with 20+ nodes

---

## Verification Commands

```bash
# Type check
npm run typecheck

# Build
npm run build

# Start dev and test manually
npm run dev
```

## Manual Test Steps

1. Open application in browser
2. Navigate to Flow editor tab
3. Verify "Auto Arrange" button visible in top-left panel
4. Observe current node positions (should be in grid layout)
5. Click "Auto Arrange"
6. Verify button shows "Arranging..." briefly
7. Verify nodes rearrange into left-to-right layered layout
8. Verify view auto-fits to show all nodes
9. Verify edges flow cleanly left-to-right
10. Verify no console errors
