# Diagnostic Actions Implementation Plan - Summary
Generated: 2026-01-28-070815
Source: EVALUATION-2026-01-28-070441.md
Topic: diagnostic-actions

## Executive Summary

**Current State**: 5% complete (stub types only)
**Target State**: Full DiagnosticAction implementation with UI
**Blockers**: None - all dependencies ready
**Overall Confidence**: MEDIUM-HIGH (one MEDIUM item in Sprint 3)

## Sprint Overview

### Sprint 1: Type Definitions (READY FOR IMPLEMENTATION)
- **Status**: HIGH confidence (3 items, 0 MEDIUM, 0 LOW)
- **Goal**: Replace stub interface with spec-compliant discriminated union
- **Effort**: 1-2 hours
- **Dependencies**: None
- **Deliverables**:
  - 7-variant DiagnosticAction discriminated union
  - Type guards for safe discrimination
  - JSDoc documentation with Action Determinism Contract

### Sprint 2: Action Attachment (READY FOR IMPLEMENTATION)
- **Status**: HIGH confidence (3 items, 0 MEDIUM, 0 LOW)
- **Goal**: Attach actions to relevant diagnostics
- **Effort**: 2-3 hours
- **Dependencies**: Sprint 1 (Type Definitions)
- **Deliverables**:
  - E_TIME_ROOT_MISSING gets createTimeRoot action
  - W_GRAPH_DISCONNECTED_BLOCK gets goToTarget + removeBlock actions
  - Type mismatch diagnostics get addAdapter action (if compiler context sufficient)

### Sprint 3: Action Executor (PARTIALLY READY)
- **Status**: MEDIUM-HIGH confidence (4 HIGH items, 1 MEDIUM item, 0 LOW)
- **Goal**: Central dispatch function routing actions to store mutations
- **Effort**: 4-6 hours
- **Dependencies**: Sprint 1, Sprint 2
- **MEDIUM Item**: insertBlock handler (block positioning unclear)
- **Deliverables**:
  - Action executor module with executeAction dispatcher
  - Handlers for all 7 action kinds
  - Error handling and validation
  - Event emission for graph mutations

### Sprint 4: UI Components (READY FOR IMPLEMENTATION)
- **Status**: HIGH confidence (3 items, 0 MEDIUM, 0 LOW)
- **Goal**: Action buttons in DiagnosticConsole UI
- **Effort**: 3-4 hours
- **Dependencies**: Sprint 3 (Action Executor)
- **Deliverables**:
  - Action buttons in DiagnosticRow component
  - Button click handlers executing actions
  - Visual feedback (loading, success, error)
  - Styled buttons matching UI theme

### Sprint 5: Testing (READY FOR IMPLEMENTATION)
- **Status**: HIGH confidence (5 items, 0 MEDIUM, 0 LOW)
- **Goal**: Comprehensive test coverage
- **Effort**: 4-6 hours
- **Dependencies**: All previous sprints
- **Deliverables**:
  - Unit tests for action executor (>90% coverage)
  - Integration tests for action attachment and execution
  - UI component tests for button rendering/interaction
  - E2E test for complete user flow
  - Test coverage: >90% for critical paths

## Total Scope

**Work Items**: 19 total
- P0 (Critical): 11 items
- P1 (High): 7 items
- P2 (Medium): 1 item

**Estimated Effort**: 16-24 hours total

**Files Created**: 15 planning files
- 5 PLAN.md files (sprint plans)
- 5 DOD.md files (definitions of done)
- 5 CONTEXT.md files (implementation context)

## Implementation Order

1. **Sprint 1: type-defs** (1-2 hours)
   - No dependencies
   - Foundation for all other work
   - Command: `/do:it diagnostic-actions/type-defs`

2. **Sprint 2: action-attach** (2-3 hours)
   - Requires Sprint 1
   - Makes diagnostics actionable
   - Command: `/do:it diagnostic-actions/action-attach`

3. **Sprint 3: action-exec** (4-6 hours)
   - Requires Sprint 1, 2
   - Core execution logic
   - Note: insertBlock handler may need research
   - Command: `/do:it diagnostic-actions/action-exec`

4. **Sprint 4: ui-buttons** (3-4 hours)
   - Requires Sprint 3
   - User-facing feature
   - Command: `/do:it diagnostic-actions/ui-buttons`

5. **Sprint 5: testing** (4-6 hours)
   - Requires all previous sprints
   - Locks in quality
   - Command: `/do:it diagnostic-actions/testing`

## Key Insights from Gap Analysis

### What's Complete (5%)
- Stub DiagnosticAction interface exists
- Diagnostic type has optional actions field
- Infrastructure ready (PatchStore, SelectionStore, EventHub)

### What's Missing (95%)
- Spec-compliant type definitions
- Action attachment at diagnostic creation sites
- Action executor/dispatcher
- UI components (action buttons)
- Test coverage

### Why It's Missing
- Explicitly deferred to Sprint 2 per spec and code comments
- Not a blocker - deliberate prioritization decision

### No Ambiguities Found
- Spec is clear and explicit (lines 368-379, 835-854)
- All dependencies exist and are ready
- Implementation path is straightforward

## Confidence Breakdown

**HIGH Confidence Sprints** (4 of 5): Ready for immediate implementation
- Sprint 1: Type Definitions
- Sprint 2: Action Attachment
- Sprint 4: UI Components
- Sprint 5: Testing

**PARTIALLY READY Sprint** (1 of 5): Most work is HIGH, one item MEDIUM
- Sprint 3: Action Executor
  - HIGH: goToTarget, createTimeRoot, removeBlock, openDocs, muteDiagnostic
  - MEDIUM: insertBlock (block positioning unclear), addAdapter (edge manipulation complex)

## Risk Assessment

**Low Risk Items** (90% of work):
- Type definitions: Spec provides exact types
- Action attachment: Clear diagnostic candidates
- goToTarget, createTimeRoot, removeBlock: Straightforward store operations
- UI buttons: Standard React patterns
- Testing: Standard test patterns

**Medium Risk Items** (10% of work):
- insertBlock positioning: No layout system found
- addAdapter: Complex edge manipulation
- Mitigation: Implement basic versions, document limitations

## Success Criteria

### Sprint 1 Success
- [ ] DiagnosticAction is discriminated union with 7 variants
- [ ] TypeScript compilation succeeds
- [ ] Type guards exported and working

### Sprint 2 Success
- [ ] E_TIME_ROOT_MISSING has createTimeRoot action
- [ ] W_GRAPH_DISCONNECTED_BLOCK has 2 actions
- [ ] Actions have correct types and IDs

### Sprint 3 Success
- [ ] executeAction function dispatches correctly
- [ ] All 7 action kinds have handlers
- [ ] Success/failure results returned
- [ ] Store mutations work correctly

### Sprint 4 Success
- [ ] Action buttons appear in DiagnosticRow
- [ ] Button clicks execute actions
- [ ] Visual feedback for loading/errors
- [ ] UI matches theme

### Sprint 5 Success
- [ ] >90% test coverage for critical paths
- [ ] All tests pass (unit, integration, E2E)
- [ ] E2E test verifies complete user flow

## Next Steps

**Immediate**: Start with Sprint 1 (Type Definitions)
```bash
/do:it diagnostic-actions/type-defs
```

**After Sprint 1**: Proceed to Sprint 2 (Action Attachment)
**After Sprint 2**: Proceed to Sprint 3 (Action Executor)
**After Sprint 3**: Proceed to Sprint 4 (UI Components)
**After Sprint 4**: Proceed to Sprint 5 (Testing)

## Files Generated

All files are in `.agent_planning/diagnostic-actions/`:

```
SPRINT-2026-01-28-070815-type-defs-PLAN.md (5.3K)
SPRINT-2026-01-28-070815-type-defs-DOD.md (1.5K)
SPRINT-2026-01-28-070815-type-defs-CONTEXT.md (7.9K)

SPRINT-2026-01-28-070815-action-attach-PLAN.md (6.4K)
SPRINT-2026-01-28-070815-action-attach-DOD.md (2.1K)
SPRINT-2026-01-28-070815-action-attach-CONTEXT.md (10K)

SPRINT-2026-01-28-070815-action-exec-PLAN.md (12K)
SPRINT-2026-01-28-070815-action-exec-DOD.md (3.5K)
SPRINT-2026-01-28-070815-action-exec-CONTEXT.md (15K)

SPRINT-2026-01-28-070815-ui-buttons-PLAN.md (6.7K)
SPRINT-2026-01-28-070815-ui-buttons-DOD.md (3.1K)
SPRINT-2026-01-28-070815-ui-buttons-CONTEXT.md (14K)

SPRINT-2026-01-28-070815-testing-PLAN.md (8.3K)
SPRINT-2026-01-28-070815-testing-DOD.md (3.5K)
SPRINT-2026-01-28-070815-testing-CONTEXT.md (15K)
```

**Total**: 107K of implementation guidance

## Planning Quality Checklist

✅ **Confidence Tags**: Every work item tagged HIGH/MEDIUM/LOW
✅ **Acceptance Criteria**: 2-5 per work item (MANDATORY requirement met)
✅ **Dependencies**: Clearly documented per sprint
✅ **Context Files**: Complete with file paths, line numbers, code examples
✅ **DOD Files**: Testable, objective criteria
✅ **Sprint Status**: Derived from work item confidence mix
✅ **Unknowns**: Documented with exit criteria for MEDIUM items
✅ **Traceability**: Links to EVALUATION and spec sections
✅ **Completeness**: All gaps covered from evaluation
✅ **Realism**: Effort estimates account for complexity

---

**Status**: ✅ PLANNING COMPLETE - Ready for implementation
**Next Command**: `/do:it diagnostic-actions/type-defs`
