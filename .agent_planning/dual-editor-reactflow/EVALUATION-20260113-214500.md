# Evaluation: Dual Editor Implementation (ReactFlow + Rete)

**Date:** 2026-01-13 21:45
**Topic:** dual-editor-reactflow
**Status:** CONTINUE

---

## Executive Summary

The codebase is well-positioned for dual editor implementation. Only 3 files import from `src/ui/editor/`, and the tab system is already generic. Main work: (1) rename directory, (2) create EditorHandle abstraction, (3) implement ReactFlow editor.

---

## 1. Current Tab System

**Location:** `src/ui/components/app/Tabs.tsx` (lines 11-116)
- Generic `TabConfig[]` interface: `{ id, label, icon?, component }`
- Already supports multiple components
- No changes needed to tab infrastructure

**Current Editor Tab:** `App.tsx` lines 74-78
```typescript
{ id: 'editor', label: 'Editor', component: ReteEditor }
```

---

## 2. Files Importing Editor Module

Only **3 files** import from `src/ui/editor/`:

1. `src/ui/components/app/App.tsx` (line 25)
   - `import { ReteEditor, EditorProvider } from '../../editor'`

2. `src/ui/components/BlockLibrary.tsx` (lines 18-19)
   - `import { useEditor } from '../editor/EditorContext'`
   - `import { addBlockToEditor } from '../editor/sync'`

3. `src/ui/components/__tests__/BlockLibrary.test.tsx` (line 1)
   - `import { EditorProvider } from '../../editor/EditorContext'`

---

## 3. Current Editor Files

```
src/ui/editor/
├── EditorContext.tsx (1042 B) - React context (ReteEditorHandle specific)
├── ReteEditor.tsx (9518 B) - Main component + plugins
├── ReteEditor.css (943 B) - Styling
├── sync.ts (8236 B) - Bidirectional PatchStore sync
├── nodes.ts (1854 B) - OscillaNode class
├── sockets.ts (3439 B) - Socket type system
└── index.ts (245 B) - Exports
```

---

## 4. Abstraction Gap

**ReteEditorHandle** (lines 41-46 of ReteEditor.tsx) exposes raw Rete types:
```typescript
export interface ReteEditorHandle {
  editor: NodeEditor<Schemes>;
  area: AreaPlugin<Schemes, AreaExtra>;
  connection: ConnectionPlugin<Schemes, AreaExtra>;
  arrange?: any;
}
```

**Issue:** Code using `ReteEditorHandle` is tightly coupled to Rete.
**Solution:** Create generic `EditorHandle` interface that both editors implement.

---

## 5. ReactFlow Requirements

**Packages needed:** `reactflow` (^11.x or ^12.x)

**Feature parity (P1 scope):**
- Pan/zoom - Native in ReactFlow
- Add/delete nodes - Via setNodes
- Create/delete connections - Via onConnect/onEdgesChange
- Node drag - Native in ReactFlow

**Deferred:**
- Minimap, Auto-layout, Undo/redo

---

## 6. Verdict

**CONTINUE** - Well-scoped, clear implementation path, good architecture foundation.
