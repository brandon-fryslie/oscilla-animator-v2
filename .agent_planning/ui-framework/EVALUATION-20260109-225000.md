# UI Framework Evaluation
Generated: 2026-01-09 22:50:00

## Topic
Flexible panel-based UI layout system using jsPanel4 and MUI

## Current State

### What Exists

1. **Basic HTML Layout** (`public/index.html`)
   - Static split-view: 40% patch viewer, 60% animation
   - Hard-coded CSS grid layout
   - Fixed header, log container at bottom
   - Floating controls/stats overlay
   - No resizable panels
   - No tabs
   - Not composable

2. **Main Application** (`src/main.ts`)
   - Steel-thread demo driving the UI
   - Directly references DOM elements by ID
   - PatchViewer, canvas, log panel, block inspector
   - Zoom/pan on canvas
   - No abstraction for UI panels

3. **Dependencies**
   - Mermaid (diagram rendering) - already installed
   - No UI framework yet (no MUI, no jsPanel)
   - Vite dev server
   - TypeScript

4. **jsPanel4 Fork** (`~/code/brandon-fryslie_jsPanel4`)
   - Dependency-free panel library
   - Extensions: modal, tooltip, hint, contextmenu, dialog, dock, layout, datepicker
   - `dock` extension for master/slave panel relationships
   - `layout` extension for saving/restoring panel positions
   - No build system working (gulpfile missing)
   - ES6 module exports available

### What's Missing

1. **Panel System**
   - No resizable panels
   - No draggable panels
   - No tab support within panels
   - No panel splitting (horizontal/vertical)
   - No duplicate panel instances
   - No docking

2. **Layout Manager**
   - No layout serialization/restoration
   - No preset layouts (left sidebar, right sidebar, etc.)
   - No panel arrangement orchestration

3. **UI Components (MUI)**
   - No Material UI installed
   - No themed components
   - No consistent design system

4. **Integration Layer**
   - No abstraction between jsPanel and app content
   - No panel registration system
   - No panel-content lifecycle management

## Reference: UI Design Mockup

From the provided screenshot:

```
┌────────────────────────────────────────────────────────────────────┐
│  Toolbar: Connections | Palette | Paths | Startup | Actions       │
├───────────────┬─────────────────────────┬──────────────────────────┤
│ Left Sidebar  │  Canvas (Preview)       │  Right Sidebar           │
│               │                         │                          │
│ - LIBRARY     │                         │  - CONTROLS / DEBUG      │
│   - Blocks    │                         │    - Overview/Probes/    │
│   - Search    │                         │      Console tabs        │
│   - Macros    ├─────────────────────────┤                          │
│               │  PATCH BAY              │  - help/tutorial         │
│ - INSPECTOR   │  - Lanes/Table/Recipe/  │  - debugger              │
│               │    Board tabs           │  - control surfaces      │
│               │  - Status bar           │                          │
│               │                         │  - HISTORY               │
│               │                         │  - HELP                  │
├───────────────┴─────────────────────────┴──────────────────────────┤
│  Logs (collapsible)                                    ERROR btn   │
└────────────────────────────────────────────────────────────────────┘
```

Key UI elements identified:
- **Toolbar** at top (fixed)
- **Left sidebar**: Block library + Inspector (vertical split or tabs)
- **Center**: Canvas (top) + Patch Bay (bottom) - horizontal split
- **Right sidebar**: Debug/Controls (top) + History/Help (bottom) - vertical split with tabs
- **Bottom**: Log panel (collapsible)
- **Tabs** within panels (Lanes/Table/Recipe/Board, Overview/Probes/Console)

## Requirements Analysis

### Core Requirements
1. **Resizable panels** - drag borders to resize
2. **Tabs within panels** - multiple views in same panel slot
3. **Split panels** - divide panel into sub-panels (H/V)
4. **Duplicate panels** - same panel type, multiple instances
5. **Preset layouts** - "left sidebar with horizontal split, center panel with tabs, right sidebar with tabs and splits"
6. **Space efficiency** - compact, information-dense

### Technology Stack
- **jsPanel4** (user's fork) - panel framework
- **MUI** (Material UI) - component library
- Both need to be added as dependencies

## Architecture Decisions Needed

### Q1: jsPanel4 Integration Strategy
Options:
a) **npm link** to local fork (allows local edits)
b) **Copy source** into project (full control)
c) **Publish fork** to npm (clean but more overhead)

**Recommendation**: Option (a) npm link for development, with path to (c) for production

### Q2: Panel Content Abstraction
How do we manage what goes inside panels?
a) **React components** inside jsPanel containers
b) **Vanilla TypeScript classes** (like PatchViewer)
c) **Hybrid** - MUI for controls, vanilla for canvas/rendering

**Recommendation**: Option (c) - Canvas/Mermaid stay vanilla, controls use MUI

### Q3: Tab Implementation
Options:
a) **jsPanel's built-in** (if available)
b) **MUI Tabs** inside panel content
c) **Custom tab component**

**Recommendation**: Option (b) - MUI Tabs for consistency

### Q4: Layout Persistence
Options:
a) **localStorage** via jsPanel.layout extension
b) **Application state** with manual serialization
c) **Both** - jsPanel handles position, app handles content state

**Recommendation**: Option (c)

## Dependencies to Add

```json
{
  "dependencies": {
    "@mui/material": "^5.x",
    "@emotion/react": "^11.x",
    "@emotion/styled": "^11.x"
  }
}
```

Plus jsPanel4 via npm link.

## Risks

1. **jsPanel4 build system broken** - gulpfile missing
   - Mitigation: Use pre-built dist/ or es6module/ directly

2. **jsPanel4 + MUI style conflicts**
   - Mitigation: Use jsPanel for structure, MUI for inner content

3. **Performance with many panels**
   - Mitigation: Lazy content loading, virtualization for lists

4. **Complexity of panel state management**
   - Mitigation: Start with static layout, add flexibility incrementally

## Verdict: CONTINUE

The path forward is clear. No blocking ambiguities - we can proceed with planning using the recommended options above.

## Next Steps

1. Set up jsPanel4 integration
2. Add MUI dependencies
3. Create panel registration/factory system
4. Implement core layout with toolbar, sidebars, center
5. Add tab support
6. Wire up existing components (PatchViewer, canvas, log)
