# User Response: Rails Foundation Sprint Plan

**Timestamp**: 2026-01-09T07:37:00Z
**Response**: APPROVED

## Approved Plan Files

- `.agent_planning/buses-and-rails/PLAN-20260109-073500.md`
- `.agent_planning/buses-and-rails/DOD-20260109-073500.md`
- `.agent_planning/buses-and-rails/CONTEXT-20260109-073500.md`

## Sprint Goal (Approved)

Establish the foundational type system for block/edge roles and implement 6 rail blocks that provide the global temporal modulation infrastructure (time, phaseA, phaseB, pulse, palette, energy).

## Approved Deliverables

### P0: BlockRole & DerivedBlockMeta Types
- Add discriminated union types to `src/types/index.ts`
- BlockRole with `user` and `derived` variants
- DerivedBlockMeta with 5 meta kinds
- EdgeRole with 4 variants

### P1: TimeRoot Output Corrections
- Rename outputs: `t` -> `tMs`, `phase` -> `phaseA`, add `phaseB`
- Fix types: `tMs` = int, `pulse` = discrete
- Add `palette` output (HSV rainbow from phaseA)
- Fix `eventType()` helper

### P2: Rail Blocks & Normalization Injection
- Create 6 rail block definitions
- Update `normalize.ts` to inject rails
- Wire rails to TimeRoot outputs

## User Decisions Applied

1. **Palette**: HSV rainbow - `palette(t) = HSV(phaseA, 1.0, 0.5)`
2. **Energy**: Keep as 6th rail
3. **Scope**: Rails only - BusBlock deferred

## Out of Scope (Deferred)

- BusBlock implementation
- Multi-writer combine logic
- DefaultSource injection
- EdgeRole runtime enforcement
